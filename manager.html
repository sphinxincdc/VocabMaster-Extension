<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HORD English Companion</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="manager.css" />
  <link rel="stylesheet" href="theme.css" />
  <style>
    body{margin:0;background:#f5f7fb;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
    .hero{position:relative;
      background: linear-gradient(135deg, #312e81 0%, #5b21b6 45%, #7c3aed 100%);
      color:#fff;padding:14px 18px 14px;
    }
    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(180deg,rgba(15,23,42,.18),rgba(15,23,42,.08));
      pointer-events:none;
    }
    .hero > .container{position:relative;z-index:1}
    .hero h1{margin:0}
    .heroHead{
      display:grid;
      grid-template-columns:minmax(0,1fr) auto;
      align-items:flex-start;
      gap:14px;
    }
    .titleWrap{display:flex;align-items:flex-start;justify-content:flex-start;gap:0}
    .titleText{display:flex;flex-direction:column;align-items:flex-start;gap:1px;min-width:0}
    .brandEyebrow{display:none}
    .titleLine{display:flex;align-items:baseline;gap:10px;flex-wrap:wrap}
    .titleHord{font-size:60px;line-height:1;font-weight:950;color:#ddd6fe;text-shadow:0 2px 12px rgba(15,23,42,.24)}
    .titleDot{font-size:58px;line-height:1;font-weight:900;color:#1e1b4b;opacity:.92}
    .titleCn{font-size:60px;line-height:1;font-weight:950;color:#0f172a}
    .verInline{font-size:30px;font-weight:900;color:#e9d5ff;opacity:.95}
    .titleOwn{font-size:68px;line-height:1.02;font-weight:940;color:#f5f3ff;text-shadow:0 3px 14px rgba(15,23,42,.3);margin-top:4px}
    .titleCNSub{font-size:44px;line-height:1.12;font-weight:820;color:#e2e8f0;margin-top:8px}
    .titleDesc{
      margin-top:8px;
      max-width:1220px;
      font-size:22px;
      line-height:1.55;
      font-weight:500;
      color:#e2e8f0;
      text-shadow:0 1px 0 rgba(15,23,42,.22);
      white-space:nowrap;
    }
    .tagline{font-size:12px;font-weight:800;letter-spacing:.02em;opacity:.9;color:#c7d2fe;margin-top:2px}
    .brandSignature{display:none}
    @media (max-width:1200px){
      .brandEyebrow{font-size:13px}
      .titleHord,.titleCn{font-size:54px}
      .titleOwn{font-size:60px}
      .titleCNSub{font-size:36px}
      .titleDesc{font-size:20px}
      .verInline{font-size:24px}
    }
    @media (max-width:880px){
      .brandEyebrow{font-size:12px;letter-spacing:.35em}
      .titleHord,.titleCn{font-size:36px}
      .titleDot{font-size:34px}
      .titleOwn{font-size:42px}
      .titleCNSub{font-size:24px}
      .titleDesc{font-size:16px;white-space:normal}
      .verInline{font-size:18px}
    }
    @media (max-width:560px){
      .brandEyebrow{font-size:10px;letter-spacing:.25em}
      .titleHord,.titleCn{font-size:28px}
      .titleDot{font-size:26px}
      .titleOwn{font-size:30px}
      .titleCNSub{font-size:18px}
      .titleDesc{font-size:14px;white-space:normal}
      .verInline{font-size:14px}
    }
    .hero .meta{margin-top:8px;opacity:.95;font-size:12px;display:flex;flex-wrap:wrap;gap:8px 12px;align-items:center;line-height:1.5;max-width:100%}
    .hero .meta span{max-width:100%;word-break:break-word}
    .hero .progressRow{margin-top:8px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .hero .progress{flex:1;min-width:220px;background:rgba(255,255,255,.16);border:1px solid rgba(255,255,255,.22);border-radius:999px;overflow:hidden;height:12px}
    .hero .progress > div{height:100%;width:0%;background:rgba(255,255,255,.92)}
    .hero .badgeRow{display:flex;gap:8px;flex-wrap:wrap}
    .hero .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,.28);background:rgba(255,255,255,.14);color:#fff;border-radius:999px;padding:6px 10px;font-weight:900;font-size:12px}
    .hero .meta .break{flex-basis:100%;height:0;}
    .hero .meta span{display:inline-flex;align-items:center;gap:6px}
    .tabsBar{margin-top:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .tabs{display:flex;gap:10px}
    .tab{border:1px solid rgba(255,255,255,.35);background:rgba(255,255,255,.12);color:#fff;border-radius:999px;padding:8px 12px;font-weight:800;cursor:pointer}
    .tab.active{background:#fff;color:#111;border-color:#fff}
    .reviewBtn{margin-left:auto;border:0;border-radius:999px;padding:10px 14px;font-weight:1000;cursor:pointer;background:rgba(255,255,255,.92);color:#111;display:inline-flex;align-items:center;gap:8px;box-shadow:0 10px 24px rgba(0,0,0,.18)}
    .reviewBtn:hover{transform:translateY(-1px)}
    .heroCtaStack{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      justify-self:end;
      gap:10px;
      min-width:320px;
      margin-top:2px;
    }
    .heroBrandRow{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .heroBrandChip{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border-radius:14px;
      border:1px solid rgba(124,58,237,.2);
      background:rgba(255,255,255,.72);
      box-shadow:0 6px 16px rgba(15,23,42,.08);
      min-width:0;
    }
    .heroBrandLink{
      cursor:pointer;
      appearance:none;
      -webkit-appearance:none;
      text-align:left;
    }
    .heroBrandLink:hover{
      transform:translateY(-1px);
      box-shadow:0 10px 18px rgba(15,23,42,.12);
    }
    .heroBrandLogo{
      width:34px;
      height:34px;
      border-radius:10px;
      object-fit:cover;
      flex:0 0 34px;
    }
    .heroBrandText{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:2px;
      line-height:1.1;
    }
    .heroBrandMain{
      font-size:13px;
      font-weight:900;
      color:#0f172a;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:240px;
    }
    .heroBrandMain .hord{
      color:#7c3aed;
    }
    .heroBrandSite{
      margin-left:8px;
      font-size:11px;
      color:#64748b;
      font-weight:800;
      border:1px solid rgba(100,116,139,.28);
      border-radius:999px;
      padding:1px 8px;
      vertical-align:middle;
    }
    .heroBrandSub{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:#64748b;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:240px;
    }
    .heroCtaBtn{
      border:1px solid rgba(255,255,255,.4);
      background:rgba(255,255,255,.2);
      color:#fff;
      border-radius:999px;
      padding:8px 14px;
      font-size:12px;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }
    .heroCtaBtn.primary{
      border-color:transparent;
      background:linear-gradient(135deg,#7c3aed,#8b5cf6);
      box-shadow:0 10px 22px rgba(79,70,229,.25);
    }
    .heroCtaBtn.pro{
      background:rgba(34,197,94,.2);
      border-color:rgba(134,239,172,.45);
      color:#dcfce7;
      cursor:default;
    }
    @media (max-width:980px){
      .heroHead{display:flex;flex-direction:column;gap:8px}
      .heroCtaStack{
        width:100%;
        flex-direction:row;
        justify-content:flex-start;
        align-items:center;
        min-width:0;
        flex-wrap:wrap;
      }
      .heroBrandRow{width:100%;justify-content:flex-start;}
      .heroBrandChip{max-width:100%;}
    }
    .container{max-width:1200px;margin:0 auto;padding:14px 14px 40px;}
    .cards{display:grid;grid-template-columns:repeat(6,minmax(120px,1fr));gap:12px;margin-top:14px}
    @media (max-width: 980px){ .cards{grid-template-columns:repeat(2,minmax(0,1fr));} }
    .card{background:rgba(255,255,255,.92);border-radius:18px;padding:8px 10px 6px 14px;box-shadow:0 10px 30px rgba(0,0,0,.12);min-height:0;display:flex;flex-direction:column;gap:2px}
    .card h3{margin:0;font-size:14px;font-weight:900;}
.card--red{background:rgba(255,80,80,.18)}
.card--orange{background:rgba(255,170,0,.18)}
.card--green{background:rgba(0,200,120,.18)}
.card--purple{background:rgba(170,90,255,.18)}
.card--indigo{background:rgba(90,120,255,.18)}
.card--sky{background:rgba(80,170,255,.20)}
.card--amber{background:rgba(255,210,0,.18)}

    .card .label{color:#6b7280;font-size:9px;font-weight:800}
    .card .value{margin-top:1px;font-size:15px;font-weight:900}
    .card .bar{display:none}
    .card .bar > div{height:100%;width:0%}
    .toolbar{margin-top:14px;background:#fff;border-radius:16px;padding:12px;box-shadow:0 10px 28px rgba(0,0,0,.06);display:flex;gap:10px;align-items:center;flex-wrap:nowrap;position:sticky;top:10px;z-index:10;overflow-x:auto}
    .toolbar,.toolbar *{box-sizing:border-box}
    .toolbar-right{margin-left:auto;display:flex;gap:10px;align-items:center;flex-wrap:nowrap;flex:0 0 auto}
    .input{border:1px solid #e5e7eb;border-radius:12px;padding:10px 12px;background:#fff;min-width:220px}
    /* Search: keep size stable on focus (no popover expansion => no layout shift) */
    .searchPopoverWrap{
      position:relative;
      flex: 1 1 420px;
      min-width: 260px;
      max-width: 420px;
      z-index:6;
    }
    .searchInput{
      position:relative;
      z-index:1;
      width:100%;
      min-width:0;
      max-width:100%;
      text-align:left;
      border:1px solid #e5e7eb; /* keep 1px in all states */
      transition: box-shadow .18s ease, background .18s ease, border-color .18s ease;
    }
    .searchInput::placeholder{ text-align:left; }
    .searchInput:focus{
      outline:none;
      border-color:#6B5BFF;
      box-shadow:0 0 0 3px rgba(107,91,255,0.18);
    }
    @media (max-width:1200px){.searchPopoverWrap{max-width:360px}}
    @media (max-width:980px){.searchPopoverWrap{max-width:260px}}
    .select{border:1px solid #e5e7eb;border-radius:12px;padding:10px 12px;background:#fff}
    .btn{border:0;border-radius:12px;padding:10px 12px;font-weight:900;cursor:pointer}
    .btn.primary{background:#4f46e5;color:#fff}
    .btn.danger{background:#ef4444;color:#fff}
    .btn.danger-light{background:#fecaca;color:#991b1b}
    .btn.danger-deep{background:#b91c1c;color:#fff}
    .btn.ghost{background:#f3f4f6;color:#111}
    .btn.green{background:#22c55e;color:#fff}
    .btn.yellow{background:#f59e0b;color:#111}
    .btn.purple{background:#7c3aed;color:#fff}
    .btn.dark{background:#111827;color:#fff}
    .tableWrap{margin-top:12px;background:#fff;border-radius:16px;box-shadow:0 10px 28px rgba(0,0,0,.06);overflow:hidden}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{position:sticky;top:0;background:#fafafa;border-bottom:1px solid #eee;padding:12px 10px;font-size:12px;text-align:left;color:#6b7280}
    tbody td{border-bottom:1px solid #f1f1f1;padding:12px 10px;vertical-align:top}
    tbody tr:hover{background:#fcfcff}
    .word{font-size:18px;font-weight:900}
    .muted{color:#6b7280;font-size:12px}
    .phon{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;font-weight:800;font-size:12px;background:#fff}
    .speak{border:0;background:#111827;color:#fff;border-radius:10px;padding:6px 8px;cursor:pointer;font-weight:900}
    .statusBtn{min-width:100px}
    .noteTag{display:inline-flex;align-items:center;gap:6px;background:#f3e8ff;color:#6b21a8;border-radius:999px;padding:5px 10px;font-weight:900;font-size:12px}
    .noteText{color:#7c3aed;font-weight:800;white-space:pre-wrap}
    /* NOTE: avoid flex on table cells/headers (can create phantom right whitespace in fixed-layout tables) */
    .right{text-align:right}
    .empty{padding:28px;text-align:center;color:#6b7280}
    .sectionTitle{margin-top:16px;margin-bottom:8px;font-weight:900;color:#111827}
    .hintBox{margin-top:10px;background:#f8fafc;border:1px dashed #e5e7eb;border-radius:14px;padding:12px;color:#475569;font-size:12px;line-height:1.5}
    .modalMask{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:999999}
    .modal{width:min(760px,92vw);background:#fff;border-radius:18px;box-shadow:0 30px 80px rgba(0,0,0,.25);overflow:hidden}
    .modalHd{padding:14px 16px;background:#111827;color:#fff;font-weight:900;display:flex;justify-content:space-between;align-items:center}
    .modalBd{padding:14px 16px}
    .modalFt{padding:12px 16px;display:flex;gap:10px;justify-content:flex-end;border-top:1px solid #eee}
    .quoteModalMask{position:fixed;inset:0;background:rgba(15,23,42,.45);display:none;align-items:center;justify-content:center;z-index:1000000}
    .quoteModal{width:min(760px,94vw);background:#fff;border-radius:18px;box-shadow:0 30px 80px rgba(0,0,0,.25);overflow:hidden}
    .quoteModalHd{padding:14px 16px;background:#111827;color:#fff;font-weight:900;display:flex;justify-content:space-between;align-items:center;gap:12px}
    .quoteModalBd{padding:14px 16px;display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .quoteSettings{display:flex;flex-direction:column;gap:10px}
    .quoteField{display:flex;flex-direction:column;gap:6px}
    .quoteField label{font-size:12px;font-weight:800;color:#475569}
    .quoteOptionGroup{display:flex;gap:8px;flex-wrap:wrap}
    .quoteOptionGroup .pill{cursor:pointer}
    .quoteChecks{display:flex;flex-direction:column;gap:8px}
    .quoteChecks label{display:flex;align-items:center;gap:8px;font-size:13px;color:#334155;font-weight:700}
    .quotePreviewWrap{border:1px solid #e5e7eb;border-radius:14px;background:#f8fafc;padding:10px}
    .quotePreviewCanvas{width:100%;display:block;border-radius:12px;border:1px solid #e5e7eb;background:#fff}
    .quoteHint{font-size:12px;color:#6b7280;line-height:1.4}
    .quoteModalFt{padding:12px 16px;display:flex;gap:10px;justify-content:flex-end;border-top:1px solid #eee}
    @media (max-width:720px){.quoteModalBd{grid-template-columns:1fr}}
    textarea{width:100%;min-height:220px;border:1px solid #e5e7eb;border-radius:14px;padding:12px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;font-size:12px}
    .small{font-size:12px;color:#6b7280}
  
  /* checkbox */
  input[type="checkbox"]{ width:18px; height:18px; cursor:pointer; }
  td:first-child, th:first-child{ width:44px; text-align:center; }
  /* Table layout: fixed columns, no sticky (avoids right-side blank gap) */
  /* No horizontal overflow/phantom blank area */
  .tableWrap{overflow-x:hidden;}
  .tableWrap table{width:100%;table-layout:fixed;min-width:0;}
  /* last column: keep tight, avoid phantom right whitespace */
    #tblWords th:last-child, #tblWords td:last-child { width:104px; max-width:104px; }
#tblSent  th:last-child, #tblSent  td:last-child { width:104px; max-width:104px; }

/* Words: keep action column tight */
#tbodyWords td:last-child { width:104px; max-width:104px; text-align:center; padding-right:0 !important; padding-left:0 !important; }
#tbodyWords td:last-child button { margin:0; }

/* Sentences: keep column width but add right breathing room (match left padding feel) */
#tbodySent td:last-child { width:72px; max-width:72px; text-align:center; padding-left:0 !important; padding-right:10px !important; }
#tbodySent td:last-child button { margin:0 auto; }

/* Force header alignment for action column */
#tblWords thead th:last-child, #tblSent thead th:last-child { text-align:center !important; }
#tblWords thead th:last-child, #tblSent thead th:last-child { padding-left:0 !important; padding-right:0 !important; }

/* Sentence table wrapper: add right padding to match left padding visually */
#sentWrap{ padding-right:14px; }
#sentWrap table{ width:100%; }
  .iconBtn.pron{padding:6px 12px;font-size:12px;min-width:44px;border-radius:12px;background:#F4F6FA;border:1px solid rgba(0,0,0,0.06);color:#111827;transition:all 0.2s ease;}
  .iconBtn.pron:hover{background:#E3EAF6;box-shadow:0 2px 6px rgba(0,0,0,0.08);}
  .pronRow{gap:8px;}
  .pronCol .muted{font-size:12px;}
  .phText{font-size:12px;}
  #wordsTable th, #wordsTable td{overflow:hidden;text-overflow:ellipsis;}
  th:nth-child(5), td:nth-child(5){width:180px;}
  th:nth-child(6), td:nth-child(6){width:120px;}
  #wordsTable td:nth-child(2), #wordsTable td:nth-child(3){word-break: break-word;}

/* ====== Fix47: modal layout (no clipping) ====== */
.modalBox{ max-height: 90vh; display:flex; flex-direction:column; }
.modalBd{ flex:1; overflow:auto; }
#imexText{ min-height: 260px; height: auto; }

/* ====== Fix47: title/meta spacing ====== */
.meta{ flex-wrap: wrap; row-gap: 6px; }

.pronCol{display:flex;flex-direction:column;gap:6px}
.pronRow{display:flex;gap:8px;align-items:center}
.iconBtn.pron{padding:6px 12px;font-size:12px;border-radius:12px;background:#F4F6FA;border:1px solid rgba(0,0,0,0.06);color:#111827;transition:all 0.2s ease}
.iconBtn.pron:hover{background:#E3EAF6;box-shadow:0 2px 6px rgba(0,0,0,0.08)}
.muted{font-size:12px;opacity:.85}


/* --- Badges: right-aligned (match the right edge of the action button area) --- */
.badgeRow{
  position: static;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
  margin-top: 10px;
}
.badge{
  background: rgba(255,255,255,0.88);
  border: 1px solid rgba(255,255,255,0.65);
  box-shadow: 0 8px 18px rgba(0,0,0,0.10);
  backdrop-filter: blur(10px);
  border-radius: 14px;
  padding: 8px 10px;
}
.badge .badgeTop{ font-weight: 800; letter-spacing: .2px; }
.badge .badgeSub{ opacity: .88; }

/* --- Stat card sky for 易错词 --- */
.statCard.sky{
  background: linear-gradient(180deg, rgba(59,130,246,0.14), rgba(59,130,246,0.06));
  border: 1px solid rgba(59,130,246,0.18);
}
.chip.sky{
  background: rgba(59,130,246,0.16);
  border: 1px solid rgba(59,130,246,0.22);
  color: #1d4ed8;
}

/* --- Review mini row under progress --- */
.reviewMini{
  margin-top: 10px;
}
.reviewMiniRow{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
.reviewMiniItem{
  flex:1 1 200px;
  min-width: 200px;
  background: rgba(255,255,255,0.62);
  border: 1px solid rgba(255,255,255,0.55);
  border-radius: 14px;
  padding: 10px 12px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.08);
  position: relative;
  overflow:hidden;
}
.reviewMiniLabel{ font-size: 12px; opacity:.85; }
.reviewMiniValue{ font-size: 22px; font-weight: 900; margin-top: 2px; }
.reviewMiniCompare{ font-size: 12px; opacity:.75; margin-top: 2px; }
.miniBars{
  position:absolute;
  right:12px;
  bottom:10px;
  display:flex;
  gap:6px;
  align-items:flex-end;
  height: 28px;
}
.miniBar{
  width: 10px;
  border-radius: 6px;
  background: rgba(148,163,184,0.55);
}
.miniBar.cur{
  background: rgba(59,130,246,0.75);
}


/* === Visual System v2 (unified tokens, no logic changes) === */

body{background:var(--vb-bg);color:var(--vb-text);font-size:var(--vb-fs-body);}

/* Hero: keep structure, unify gradient + typography */
.hero{background:var(--vb-brand-grad);padding:18px 18px 12px;}
.hero h1{font-size:var(--vb-fs-h1);font-weight:800;line-height:1.2;text-align:left;max-width:1200px;margin:0 auto;}
.titleWrap{justify-content:flex-start;}
.titleText .sub{font-size:var(--vb-fs-body);}
.verInline{font-size:var(--vb-fs-cap);opacity:.85}
.tagline{font-size:var(--vb-fs-body);font-weight:800;letter-spacing:.2px;opacity:.95;color:rgba(255,255,255,.90);font-family:inherit}

/* Tabs / primary actions */
.tab{border-radius:var(--vb-r-pill);padding:8px 12px;font-weight:900;}
.tab.active{background:#fff;color:var(--vb-text);border-color:#fff}
.reviewBtn{border-radius:var(--vb-r-btn);padding:10px 12px;font-weight:900;box-shadow:var(--vb-shadow-md)}

/* Stat cards (six blocks) */
.card{border-radius:var(--vb-r-card);padding:8px 14px 6px;min-height:0;box-shadow:var(--vb-shadow-md);border:1px solid var(--vb-border);background:var(--vb-surface);gap:0}
.card h3{font-size:var(--vb-fs-body);font-weight:900;padding-left:10px}
.card .label{font-size:var(--vb-fs-cap);color:var(--vb-muted);font-weight:800}
.card .value{font-size:var(--vb-fs-h2);font-weight:900;margin-top:0;padding-left:10px}
.card-action{margin-top:0;align-self:stretch;border:1px solid var(--vb-border);background:rgba(255,255,255,.78);border-radius:var(--vb-r-pill);padding:6px 12px;font-weight:900;font-size:var(--vb-fs-cap);line-height:1.2;color:var(--vb-text);cursor:pointer}
.card-action:hover{filter:brightness(.99)}


/* Keep existing colorful backgrounds but constrain to semantic palette */
.card--red{background:var(--vb-danger-bg)}
.card--orange{background:var(--vb-warning-bg)}
.card--green{background:var(--vb-success-bg)}
.card--purple{background:#eee8fb}
.card--indigo{background:#d8f2f5}
.card--sky{background:#dbeafe}
.card--amber{background:#efe6fb}

/* Toolbar/table cards */
.toolbar{border-radius:var(--vb-r-card);padding:var(--vb-card-pad);box-shadow:var(--vb-shadow-md);border:1px solid var(--vb-border)}
.tableWrap{border-radius:var(--vb-r-card);box-shadow:var(--vb-shadow-md);border:1px solid var(--vb-border)}

/* Inputs/selects */
.input,.select{border-radius:var(--vb-r-input);border:1px solid var(--vb-border);font-size:var(--vb-fs-body)}

/* Buttons: map legacy variants into 3 types */
.btn{border-radius:var(--vb-r-btn);padding:10px 12px;font-weight:900}
.btn.primary,.btn.purple,.btn.green{background:var(--vb-brand-grad);border:0;color:#fff;box-shadow:var(--vb-shadow-md)}
.btn.ghost,.btn.yellow,.btn.dark{background:rgba(15,23,42,.05);border:1px solid var(--vb-border);color:var(--vb-text)}
.btn.danger,.btn.danger-light{background:var(--vb-danger-bg);border:1px solid var(--vb-danger-bd);color:var(--vb-danger-fg)}
.btn.danger-deep{background:#991b1b;border:1px solid #7f1d1d;color:#fff}

/* Pills / tags */
.pill{border-radius:var(--vb-r-pill);border:1px solid var(--vb-border);background:#fff;font-size:var(--vb-fs-cap)}
.noteTag{border-radius:var(--vb-r-pill);border:1px solid rgba(124,58,237,.28);background:rgba(124,58,237,.14);color:#5b21b6}

/* Table typography */
thead th{font-size:var(--vb-fs-cap)}
.word{font-size:var(--vb-fs-h2);font-weight:900}
.muted{font-size:var(--vb-fs-cap);color:var(--vb-muted)}
</style>


<style>
/* 2.50.2: badges are display-only */
.badge, .stat-badge, .display-badge {
  cursor: default !important;
  pointer-events: none !important;
  box-shadow: none !important;
}

  @media (prefers-color-scheme: dark){
    body{background:var(--vb-bg);color:var(--vb-text)}
    .hero{background:linear-gradient(135deg,#4c1d95,#1e1b4b)}
    .tagline,.brandSignature,.hero .meta{color:rgba(237,233,254,.9)}
    .card,.toolbar,.tableWrap,.hintBox,.modal,.quoteModal{background:var(--vb-surface);border:1px solid var(--vb-border);color:var(--vb-text)}
    .card .label,.muted,.small,.empty,.sectionTitle{color:var(--vb-muted)}
    .input,.select,textarea,.pill,.quotePreviewWrap,.quotePreviewCanvas{background:rgba(15,23,42,.36);border-color:var(--vb-border);color:var(--vb-text)}
    .searchInput{background:rgba(15,23,42,.36);border-color:var(--vb-border);color:var(--vb-text)}
    .searchInput:focus{border-color:#7c3aed;box-shadow:0 0 0 3px rgba(124,58,237,.20)}
    thead th{background:rgba(15,23,42,.45);border-bottom:1px solid var(--vb-border);color:var(--vb-muted)}
    tbody td{border-bottom:1px solid rgba(167,139,250,.16)}
    tbody tr:hover{background:rgba(167,139,250,.10)}
    .btn.ghost,.btn.yellow,.btn.dark{background:rgba(167,139,250,.16);border-color:var(--vb-border);color:var(--vb-text)}
    .btn.danger-light{background:var(--vb-danger-bg);border-color:var(--vb-danger-bd);color:var(--vb-danger-fg)}
    .btn.danger-deep{background:#991b1b;color:#fff}
    .modalHd,.quoteModalHd{background:rgba(12,10,25,.95);color:#ede9fe}
    .modalFt,.quoteModalFt{border-top:1px solid var(--vb-border)}
    .noteTag{background:rgba(124,58,237,.24);color:#ddd6fe}
    .noteText{color:#c4b5fd}

    .word-card,.sentence-card{background:rgba(15,23,42,.82);border:1px solid var(--vb-border);color:var(--vb-text)}
    .word-title,.sentence-text{color:var(--vb-text)}
    .word-meaning,.sentence-translation{color:var(--vb-text)}
    .word-note,.sentence-note{color:#c4b5fd}
  }

  body.vb-force-dark{background:var(--vb-bg);color:var(--vb-text)}
  body.vb-force-dark .hero{background:linear-gradient(135deg,#4c1d95,#1e1b4b)}
  body.vb-force-dark .tagline,body.vb-force-dark .brandSignature,body.vb-force-dark .hero .meta{color:rgba(237,233,254,.9)}
  body.vb-force-dark .card,body.vb-force-dark .toolbar,body.vb-force-dark .tableWrap,body.vb-force-dark .hintBox,body.vb-force-dark .modal,body.vb-force-dark .quoteModal{background:var(--vb-surface);border:1px solid var(--vb-border);color:var(--vb-text)}
  body.vb-force-dark .card .label,body.vb-force-dark .muted,body.vb-force-dark .small,body.vb-force-dark .empty,body.vb-force-dark .sectionTitle{color:var(--vb-muted)}
  body.vb-force-dark .input,body.vb-force-dark .select,body.vb-force-dark textarea,body.vb-force-dark .pill,body.vb-force-dark .quotePreviewWrap,body.vb-force-dark .quotePreviewCanvas{background:rgba(15,23,42,.36);border-color:var(--vb-border);color:var(--vb-text)}
  body.vb-force-dark .searchInput{background:rgba(15,23,42,.36);border-color:var(--vb-border);color:var(--vb-text)}
  body.vb-force-dark .searchInput:focus{border-color:#7c3aed;box-shadow:0 0 0 3px rgba(124,58,237,.20)}
  body.vb-force-dark thead th{background:rgba(15,23,42,.45);border-bottom:1px solid var(--vb-border);color:var(--vb-muted)}
  body.vb-force-dark tbody td{border-bottom:1px solid rgba(167,139,250,.16)}
  body.vb-force-dark tbody tr:hover{background:rgba(167,139,250,.10)}
  body.vb-force-dark .btn.ghost,body.vb-force-dark .btn.yellow,body.vb-force-dark .btn.dark{background:rgba(167,139,250,.16);border-color:var(--vb-border);color:var(--vb-text)}
  body.vb-force-dark .btn.danger-light{background:var(--vb-danger-bg);border-color:var(--vb-danger-bd);color:var(--vb-danger-fg)}
  body.vb-force-dark .btn.danger-deep{background:#991b1b;color:#fff}
  body.vb-force-dark .modalHd,body.vb-force-dark .quoteModalHd{background:rgba(12,10,25,.95);color:#ede9fe}
  body.vb-force-dark .modalFt,body.vb-force-dark .quoteModalFt{border-top:1px solid var(--vb-border)}
  body.vb-force-dark .noteTag{background:rgba(124,58,237,.24);color:#ddd6fe}
  body.vb-force-dark .noteText{color:#c4b5fd}

    body.vb-force-dark .word-card,body.vb-force-dark .sentence-card{background:rgba(15,23,42,.82);border:1px solid var(--vb-border);color:var(--vb-text)}
    body.vb-force-dark .word-title,body.vb-force-dark .sentence-text{color:var(--vb-text)}
    body.vb-force-dark .word-meaning,body.vb-force-dark .sentence-translation{color:var(--vb-text)}
    body.vb-force-dark .word-note,body.vb-force-dark .sentence-note{color:#c4b5fd}

</style>
  <style id="manager-ui-refine-v2">
    :root{
      --mgr-bg-0:#f4f7fc;
      --mgr-bg-1:#ffffff;
      --mgr-bg-2:#f1f5ff;
      --mgr-border:#dbe5f1;
      --mgr-text-1:#0f172a;
      --mgr-text-2:#334155;
      --mgr-text-3:#64748b;
      --mgr-brand:#5b3df5;
      --mgr-brand-600:#4a2edb;
      --mgr-danger:#b91c1c;
      --mgr-danger-bg:#fee2e2;
      --mgr-shadow:0 10px 28px rgba(15,23,42,0.07);
    }

    body{
      background:var(--mgr-bg-0);
      color:var(--mgr-text-1);
    }
    .hero{
      background:linear-gradient(120deg,#4f46e5 0%,#6d28d9 56%,#7c3aed 100%);
      position:relative;
    }
    .hero::after{
      content:"";
      position:absolute;
      left:0;
      right:0;
      bottom:-1px;
      height:40px;
      background:linear-gradient(180deg,rgba(244,247,252,0),var(--mgr-bg-0));
      pointer-events:none;
    }

    .tabs .tab{
      border:1px solid rgba(255,255,255,.36);
      background:rgba(255,255,255,.14);
    }
    .tabs .tab.active{
      background:#fff;
      color:#1e1b4b;
      box-shadow:0 6px 16px rgba(15,23,42,.18);
    }
    .reviewBtn{
      background:#fff;
      color:#1e1b4b;
    }

    .cards .card,
    .toolbar,
    .tableWrap{
      background:var(--mgr-bg-1);
      border:1px solid var(--mgr-border);
      box-shadow:var(--mgr-shadow);
    }
    .cards .card{
      border-radius:14px;
    }
    .card h3{color:var(--mgr-text-2);}
    .card .label{color:var(--mgr-text-3);}
    .card .value{color:var(--mgr-text-1);}

    .toolbar{
      gap:8px;
      border-radius:14px;
      top:12px;
    }
    .input,.select,.pill{
      border-color:var(--mgr-border);
      color:var(--mgr-text-2);
    }
    .input::placeholder{color:#94a3b8;}

    .btn{
      border:1px solid var(--mgr-border);
      border-radius:10px;
      font-weight:800;
      background:#fff;
      color:var(--mgr-text-2);
      transition:background .16s ease,border-color .16s ease,transform .16s ease;
    }
    .btn:hover{background:var(--mgr-bg-2);}
    .btn:active{transform:translateY(1px);}
    .btn.primary{
      background:linear-gradient(135deg,var(--mgr-brand),var(--mgr-brand-600));
      border-color:transparent;
      color:#fff;
    }
    .btn.ghost,.btn.yellow,.btn.dark,.btn.green{
      background:#fff;
      color:var(--mgr-text-2);
      border-color:var(--mgr-border);
    }
    .btn.danger-light{
      background:var(--mgr-danger-bg);
      border-color:#fecaca;
      color:var(--mgr-danger);
    }
    .btn.danger-deep{
      background:var(--mgr-danger);
      border-color:var(--mgr-danger);
      color:#fff;
    }
    #btnBulkCycle{
      background:#ede9fe;
      border-color:#ddd6fe;
      color:#5b21b6;
    }

    .word-card,
    .sentence-card{
      border:1px solid var(--mgr-border);
      border-radius:14px;
      box-shadow:none;
      background:var(--mgr-bg-1);
    }
    .word-card:hover,
    .sentence-card:hover{
      background:#fbfdff;
    }
    .word-title,.sentence-text{color:var(--mgr-text-1);}
    .word-meaning,.sentence-translation{color:var(--mgr-text-2);}
    .sentence-translation{opacity:.95;}
    .word-meta-line,.sentence-meta,.muted,.small{color:var(--mgr-text-3);}
    .word-note,.sentence-note{color:#6d28d9;}

    .word-card-row,
    .sentence-card-row{
      align-items:flex-start;
    }
    .word-actions .iconBtn,
    .sentence-actions .iconBtn{
      opacity:.96;
    }
    .word-actions .iconBtn:hover,
    .sentence-actions .iconBtn:hover{
      transform:translateY(-1px);
    }

    .st{
      border:1px solid transparent;
      font-size:11px;
      letter-spacing:.1px;
    }

    @media (prefers-color-scheme: dark){
      :root{
        --mgr-bg-0:#070a1b;
        --mgr-bg-1:#0f1733;
        --mgr-bg-2:#172345;
        --mgr-border:#2d3a64;
        --mgr-text-1:#e7eeff;
        --mgr-text-2:#c7d3f2;
        --mgr-text-3:#97a8d4;
        --mgr-brand:#7a6bff;
        --mgr-brand-600:#6554f3;
        --mgr-danger:#ef4444;
        --mgr-danger-bg:#3a1823;
        --mgr-shadow:0 14px 30px rgba(0,0,0,.34);
      }
      .hero{
        background:linear-gradient(120deg,#3f247e 0%,#35236f 52%,#202252 100%);
      }
      .hero::after{
        background:linear-gradient(180deg,rgba(7,10,27,0),var(--mgr-bg-0));
      }
      .cards .card{
        background:#121b38;
      }
      .word-card:hover,.sentence-card:hover{
        background:#132046;
      }
      .btn.ghost,.btn.yellow,.btn.dark,.btn.green{
        background:#141d3d;
      }
      #btnBulkCycle{
        background:#2b2351;
        border-color:#4d3f80;
        color:#ddd6fe;
      }
    }

    body.vb-force-dark{
      --mgr-bg-0:#070a1b;
      --mgr-bg-1:#0f1733;
      --mgr-bg-2:#172345;
      --mgr-border:#2d3a64;
      --mgr-text-1:#e7eeff;
      --mgr-text-2:#c7d3f2;
      --mgr-text-3:#97a8d4;
      --mgr-brand:#7a6bff;
      --mgr-brand-600:#6554f3;
      --mgr-danger:#ef4444;
      --mgr-danger-bg:#3a1823;
      --mgr-shadow:0 14px 30px rgba(0,0,0,.34);
      background:var(--mgr-bg-0);
      color:var(--mgr-text-1);
    }
    body.vb-force-dark .hero{
      background:linear-gradient(120deg,#3f247e 0%,#35236f 52%,#202252 100%);
    }
    body.vb-force-dark .hero::after{
      background:linear-gradient(180deg,rgba(7,10,27,0),var(--mgr-bg-0));
    }
    body.vb-force-dark .cards .card{background:#121b38;}
    body.vb-force-dark .word-card:hover,
    body.vb-force-dark .sentence-card:hover{background:#132046;}
    body.vb-force-dark .btn.ghost,
    body.vb-force-dark .btn.yellow,
    body.vb-force-dark .btn.dark,
    body.vb-force-dark .btn.green{background:#141d3d;}
    body.vb-force-dark #btnBulkCycle{
      background:#2b2351;
      border-color:#4d3f80;
      color:#ddd6fe;
    }

    /* ===== Fix Pack: sentence cards + toolbar (CSS only) ===== */
    #sentCards .sentence-card{
      padding:14px 16px;
    }
    #sentCards .sentence-card-row{
      align-items:center;
    }
    #sentCards .sentence-main{
      padding-right:8px;
      min-width:0;
    }
    #sentCards .sentence-actions{
      flex:0 0 164px;
      width:164px;
      margin-left:8px;
      display:grid;
      grid-template-columns:112px 36px;
      align-items:center;
      justify-content:end;
      gap:10px;
    }
    #sentCards .sentence-actions .sentence-side-actions{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }
    #sentCards .sentence-actions .sentence-export-btn{
      width:112px;
      min-height:86px;
      height:86px;
      border-radius:10px;
      padding:8px 10px;
      display:inline-flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      gap:8px;
      border:1px solid #bfdbfe;
      background:#dbeafe;
      color:#1e3a8a;
      font-weight:900;
      font-size:11px;
      line-height:1;
    }
    #sentCards .sentence-actions .sentence-export-btn::before{
      display:none;
    }
    #sentCards .sentence-actions .iconBtn{
      width:36px;
      height:36px;
    }
    #toolbarWords,
    #toolbarSentences{
      align-items:center;
      gap:10px;
    }
    #toolbarWords .input, #toolbarSentences .input,
    #toolbarWords .select, #toolbarSentences .select,
    #toolbarWords .btn, #toolbarSentences .btn{
      height:46px;
      box-sizing:border-box;
    }

    #toolbarWords .pill,
    #toolbarSentences .pill{
      flex:0 0 auto;
      white-space:nowrap;
    }
    #toolbarWords .pill label,
    #toolbarSentences .pill label{
      white-space:nowrap;
    }

    #sortDir, #sortSentenceDir{
      min-width:92px;
    }
    #btnImport, #btnExport, #btnImportSent, #btnExportSent{
      min-width:92px;
    }
    #btnExportSent.export-core-btn{
      min-width:138px;
      box-shadow:0 8px 20px rgba(79,70,229,.22);
    }

    #btnClearWords, #btnClearSentences{
      margin-left:12px;
    }
    #btnRefresh, #btnRefresh2{
      margin-left:8px;
    }

    #btnBulkCycle{
      background:#ede9fe;
      border-color:#ddd6fe;
      color:#5b21b6;
    }
    #btnBulkDelete, #btnBulkDeleteSent{
      background:#fff1f2;
      border-color:#fecdd3;
      color:#be123c;
    }

    /* Toast (used by guardFeature / showManagerToast) */
    #managerToastHost{
      position:fixed;
      right:16px;
      bottom:16px;
      z-index:2147483647;
      display:flex;
      flex-direction:column;
      gap:10px;
      pointer-events:none;
    }
    .manager-toast{
      max-width:min(420px, calc(100vw - 32px));
      padding:10px 12px;
      border-radius:12px;
      border:1px solid #fecaca;
      background:#7f1d1d;
      color:#fff;
      box-shadow:0 10px 24px rgba(15,23,42,.25);
      opacity:0;
      transform:translateY(8px);
      transition:opacity .2s ease, transform .2s ease;
      font-size:13px;
      line-height:1.35;
      font-weight:700;
    }
    .manager-toast.is-anchor{
      position:fixed;
      z-index:2147483647;
      max-width:min(320px, calc(100vw - 16px));
    }
    .manager-toast.show{
      opacity:1;
      transform:translateY(0);
    }
    .manager-toast.success{
      border-color:#86efac;
      background:#166534;
    }
    .manager-toast.error{
      border-color:#fecaca;
      background:#7f1d1d;
    }

    @media (prefers-color-scheme: dark){
      .manager-toast{
        box-shadow:0 12px 30px rgba(0,0,0,.42);
      }
      .manager-toast.error{
        border-color:#fca5a5;
        background:#991b1b;
      }
      .manager-toast.success{
        border-color:#86efac;
        background:#15803d;
      }
    }

    body.vb-force-dark .manager-toast{
      box-shadow:0 12px 30px rgba(0,0,0,.42);
    }
    body.vb-force-dark .manager-toast.error{
      border-color:#fca5a5;
      background:#991b1b;
    }
    body.vb-force-dark .manager-toast.success{
      border-color:#86efac;
      background:#15803d;
    }

    /* ===== Refinement: single-surface header + no horizontal toolbar scroll ===== */
    html, body{
      overflow-x:hidden;
    }
    .hero{
      box-shadow:none;
      border-bottom:0;
    }
    .hero::after{
      height:16px;
      background:linear-gradient(180deg, rgba(244,247,252,0.08), var(--mgr-bg-0));
    }
    .hero + .container{
      padding-top:10px;
    }
    @media (prefers-color-scheme: dark){
      .hero::after{
        background:linear-gradient(180deg, rgba(7,10,27,0.06), var(--mgr-bg-0));
      }
    }
    body.vb-force-dark .hero::after{
      background:linear-gradient(180deg, rgba(7,10,27,0.06), var(--mgr-bg-0));
    }

    #toolbarWords,
    #toolbarSentences{
      flex-wrap:wrap;
      overflow-x:clip;
      row-gap:10px;
      column-gap:10px;
    }
    #toolbarWords .searchPopoverWrap,
    #toolbarSentences .searchPopoverWrap{
      flex:1 1 320px;
      min-width:220px;
      max-width:560px;
    }
    #toolbarWords .toolbar-right,
    #toolbarSentences .toolbar-right{
      flex:0 1 auto;
      min-width:0;
      margin-left:auto;
      flex-wrap:wrap;
      justify-content:flex-end;
      row-gap:8px;
    }
    #toolbarWords .pill,
    #toolbarSentences .pill{
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    #toolbarWords .pill label,
    #toolbarSentences .pill label{
      white-space:nowrap;
    }

    /* ===== Final polish: remove split glow + stabilize toolbar rhythm ===== */
    .hero::after{
      height:0;
      background:none;
    }
    .hero + .container{
      padding-top:14px;
    }
    .titleLine{
      gap:8px;
    }
    .verInline{
      font-size:12px;
      opacity:.82;
    }
    .tagline{
      font-size:13px;
      opacity:.92;
    }
    .brandSignature{
      font-size:12px;
      letter-spacing:1.1px;
      opacity:.8;
    }

    #toolbarWords,
    #toolbarSentences{
      padding:10px;
      gap:8px;
      row-gap:8px;
      border-radius:12px;
    }
    #toolbarWords .input, #toolbarSentences .input,
    #toolbarWords .select, #toolbarSentences .select,
    #toolbarWords .btn, #toolbarSentences .btn{
      height:42px;
      padding:8px 10px;
      font-size:13px;
      border-radius:10px;
    }
    #toolbarWords .searchPopoverWrap,
    #toolbarSentences .searchPopoverWrap{
      flex:1 1 260px;
      min-width:200px;
      max-width:340px;
    }
    #toolbarWords .select,
    #toolbarSentences .select{
      min-width:94px;
    }
    #sortDir, #sortSentenceDir{
      min-width:74px;
    }
    #btnImport, #btnExport, #btnImportSent, #btnExportSent{
      min-width:66px;
    }
    #btnExportSent.export-core-btn{
      min-width:132px !important;
    }
    #toolbarWords .toolbar-right,
    #toolbarSentences .toolbar-right{
      flex-wrap:nowrap;
      gap:8px;
      row-gap:0;
    }
    #toolbarWords .pill,
    #toolbarSentences .pill{
      padding:6px 8px;
      border-radius:999px;
    }
    #toolbarWords .pill label,
    #toolbarSentences .pill label{
      font-size:13px;
      line-height:1.1;
    }
    #toolbarWords .pill label + label,
    #toolbarSentences .pill label + label{
      margin-left:6px !important;
    }

    #wordsWrap .word-card{
      border-radius:12px;
    }
    #wordsWrap .word-card-row{
      align-items:center;
    }
    #wordsWrap .word-main{
      gap:10px;
    }
    #wordsWrap .word-meta{
      gap:4px;
    }
    #wordsWrap .word-actions{
      width:64px;
      flex:0 0 64px;
      gap:6px;
      align-items:center;
    }
    #wordsWrap .word-actions .iconBtn{
      width:38px;
      height:38px;
    }

    /* ===== Requested tweaks: compact search + sticky action bar ===== */
    #toolbarWords .searchPopoverWrap,
    #toolbarSentences .searchPopoverWrap{
      flex:0 0 170px !important;
      min-width:170px !important;
      max-width:170px !important;
    }
    #toolbarWords .pill[title="全选"],
    #toolbarSentences .pill[title="全选"]{
      min-width:54px;
      justify-content:center;
      padding-left:8px;
      padding-right:8px;
    }
    #toolbarWords,
    #toolbarSentences{
      position:relative !important;
      top:auto !important;
      z-index:auto;
    }
    .toolbar-fixed-live{
      position:fixed !important;
      top:10px !important;
      z-index:5000 !important;
      margin-top:0 !important;
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter:blur(10px);
      box-shadow:0 14px 34px rgba(15,23,42,.22), 0 2px 10px rgba(15,23,42,.12);
      border:1px solid rgba(124,58,237,.28) !important;
      border-radius:14px;
      animation:toolbarDockIn .16s ease-out;
    }
    .toolbar-sticky-sentinel{
      height:0;
      margin:0;
      padding:0;
    }
    .toolbar-sticky-spacer{
      display:none;
      height:0;
    }
    @keyframes toolbarDockIn{
      from{transform:translateY(-6px);opacity:.9}
      to{transform:translateY(0);opacity:1}
    }
    body.vb-force-light .toolbar-fixed-live,
    body:not(.vb-force-dark) .toolbar-fixed-live{
      background:rgba(255,255,255,.92) !important;
    }
    body.vb-force-dark .toolbar-fixed-live,
    body.vb-dark .toolbar-fixed-live{
      background:rgba(17,24,39,.86) !important;
      border-color:rgba(139,92,246,.45) !important;
      box-shadow:0 16px 38px rgba(2,6,23,.55), 0 2px 10px rgba(2,6,23,.35);
    }
    @media (max-width:760px){
      #toolbarWords .searchPopoverWrap,
      #toolbarSentences .searchPopoverWrap{
        flex:1 1 42vw !important;
        min-width:150px !important;
        max-width:42vw !important;
      }
    }
  </style>
  <style id="manager-header-light-v4">
    body:not(.vb-force-dark) .hero{
      background:#f3f0ff !important;
      color:#0f172a;
      padding:16px 18px 12px !important;
    }
    body:not(.vb-force-dark) .hero::before,
    body:not(.vb-force-dark) .hero::after{
      display:none !important;
      background:none !important;
      height:0 !important;
    }
    body:not(.vb-force-dark) .hero > .container{
      position:relative;
      z-index:1;
    }
    body:not(.vb-force-dark) .brandEyebrow{
      display:block;
      font-size:12px;
      letter-spacing:.34em;
      color:#64748b;
      font-weight:700;
      text-transform:uppercase;
      margin-bottom:8px;
    }
    body:not(.vb-force-dark) .titleHord{
      color:#6d3df0;
      text-shadow:none;
    }
    body:not(.vb-force-dark) .titleDot,
    body:not(.vb-force-dark) .titleCn{
      color:#0f172a;
    }
    body:not(.vb-force-dark) .titleOwn{
      color:#9a63f7;
      text-shadow:none;
    }
    body:not(.vb-force-dark) .titleCNSub{
      color:#334155;
    }
    body:not(.vb-force-dark) .titleDesc{
      color:#55657a;
      text-shadow:none;
    }
    body:not(.vb-force-dark) .hero .progress{
      background:rgba(99,102,241,.14);
      border-color:rgba(99,102,241,.22);
    }
    body:not(.vb-force-dark) .hero .progress > div{
      background:linear-gradient(90deg,#7c3aed,#8b5cf6);
    }
    body:not(.vb-force-dark) .tabs .tab{
      border:1px solid #d6dcf3;
      background:#ffffff;
      color:#334155;
    }
    body:not(.vb-force-dark) .tabs .tab.active{
      background:linear-gradient(135deg,#7c3aed,#8b5cf6);
      border-color:transparent;
      color:#ffffff;
    }
    body:not(.vb-force-dark) .reviewBtn{
      background:#ffffff;
      color:#312e81;
      border:1px solid #d6dcf3;
      box-shadow:0 8px 22px rgba(79,70,229,.14);
    }
    body:not(.vb-force-dark) .heroCtaBtn{
      border:1px solid #d6dcf3;
      background:#ffffff;
      color:#334155;
    }
    body:not(.vb-force-dark) .heroCtaBtn.primary{
      border-color:transparent;
      background:linear-gradient(135deg,#7c3aed,#8b5cf6);
      color:#ffffff;
    }
    body:not(.vb-force-dark) .heroCtaBtn.pro{
      background:#ecfdf3;
      border-color:#bbf7d0;
      color:#166534;
    }
  </style>
  <style id="manager-brand-token-pass1">
    :root{
      --hord-ui-font-en:"Inter","Segoe UI","Helvetica Neue",Arial,sans-serif;
      --hord-ui-font-cjk:"Noto Sans SC","PingFang SC","Microsoft YaHei","Segoe UI",sans-serif;
      --hord-ui-bg:#f3f0ff;
      --hord-ui-surface:#ffffff;
      --hord-ui-surface-soft:#f8f6ff;
      --hord-ui-text:#0f172a;
      --hord-ui-muted:#5b6b83;
      --hord-ui-brand:#7c3aed;
      --hord-ui-brand-2:#8b5cf6;
      --hord-ui-border:rgba(17,24,39,.08);
      --hord-ui-shadow:0 8px 24px rgba(17,24,39,.08);
    }

    body{
      font-family:var(--hord-ui-font-en),var(--hord-ui-font-cjk);
      background:var(--hord-ui-bg) !important;
      color:var(--hord-ui-text);
    }

    .hero{
      background:var(--hord-ui-bg) !important;
      color:var(--hord-ui-text);
    }
    .hero::before{ display:none !important; }
    .brandEyebrow{ display:block; color:#64748b; letter-spacing:.34em; font-weight:700; }
    .titleHord{ color:var(--hord-ui-brand); text-shadow:none; }
    .titleDot,.titleCn{ color:var(--hord-ui-text); }
    .titleOwn{ color:#9f6af7; text-shadow:none; }
    .titleCNSub{ color:#334155; }
    .titleDesc{ color:var(--hord-ui-muted); text-shadow:none; }

    .tabs .tab{
      border:1px solid var(--hord-ui-border);
      background:var(--hord-ui-surface);
      color:#334155;
    }
    .tabs .tab.active{
      background:linear-gradient(135deg,var(--hord-ui-brand),var(--hord-ui-brand-2));
      border-color:transparent;
      color:#fff;
    }
    .reviewBtn,.heroCtaBtn{
      border:1px solid var(--hord-ui-border);
      background:var(--hord-ui-surface);
      color:#334155;
      box-shadow:var(--hord-ui-shadow);
    }
    .heroCtaBtn.primary{
      border-color:transparent;
      color:#fff;
      background:linear-gradient(135deg,var(--hord-ui-brand),var(--hord-ui-brand-2));
    }
    .heroCtaBtn.pro{
      background:#ecfdf3;
      border-color:#bbf7d0;
      color:#166534;
    }

    .card,
    .toolbar,
    .tableWrap,
    .hintBox,
    .modal,
    .quoteModal{
      background:var(--hord-ui-surface);
      border:1px solid var(--hord-ui-border);
      box-shadow:var(--hord-ui-shadow);
    }
    .card .label,.muted,.small,.empty{ color:var(--hord-ui-muted); }
    .card .value,.word-title,.sentence-text{ color:var(--hord-ui-text); }
    .word-meaning,.sentence-translation{ color:#334155; }
    .word-note,.sentence-note,.noteText{ color:#6d28d9; }

    .input,.select,.pill,textarea{
      background:var(--hord-ui-surface);
      border:1px solid var(--hord-ui-border);
      color:var(--hord-ui-text);
    }
    .btn.primary,.btn.purple,.btn.green{
      background:linear-gradient(135deg,var(--hord-ui-brand),var(--hord-ui-brand-2));
      color:#fff;
      border:0;
    }
    .btn.ghost,.btn.yellow,.btn.dark{
      background:var(--hord-ui-surface-soft);
      border:1px solid var(--hord-ui-border);
      color:#334155;
    }
    .btn.danger-light{ background:#fff1f2; border:1px solid #fecdd3; color:#be123c; }
    .btn.danger,.btn.danger-deep{ background:#dc2626; color:#fff; border:0; }

    @media (prefers-color-scheme: dark){
      body:not(.vb-force-light){
        --hord-ui-bg:#060914;
        --hord-ui-surface:#11172f;
        --hord-ui-surface-soft:#17203f;
        --hord-ui-text:#eef2ff;
        --hord-ui-muted:#a7b0c5;
        --hord-ui-border:rgba(148,163,184,.26);
        --hord-ui-shadow:0 10px 26px rgba(0,0,0,.34);
      }
      body:not(.vb-force-light) .hero{
        background:radial-gradient(1100px 420px at 30% 0%, rgba(124,58,237,.18), rgba(6,9,20,0)) , #060914 !important;
      }
      body:not(.vb-force-light) .titleHord{ color:#b9a7ff; }
      body:not(.vb-force-light) .titleOwn{ color:#b57cff; }
      body:not(.vb-force-light) .titleCNSub{ color:#d8def0; }
      body:not(.vb-force-light) .titleDesc{ color:#a7b0c5; }
      body:not(.vb-force-light) .tabs .tab{ color:#d5def3; }
      body:not(.vb-force-light) .reviewBtn,
      body:not(.vb-force-light) .heroCtaBtn{
        color:#e5e7eb;
      }
      body:not(.vb-force-light) .heroCtaBtn.pro{
        background:rgba(22,101,52,.28);
        border-color:rgba(74,222,128,.4);
        color:#bbf7d0;
      }
    }

    body.vb-force-dark{
      --hord-ui-bg:#060914;
      --hord-ui-surface:#11172f;
      --hord-ui-surface-soft:#17203f;
      --hord-ui-text:#eef2ff;
      --hord-ui-muted:#a7b0c5;
      --hord-ui-border:rgba(148,163,184,.26);
      --hord-ui-shadow:0 10px 26px rgba(0,0,0,.34);
    }
    body.vb-force-dark .hero{
      background:radial-gradient(1100px 420px at 30% 0%, rgba(124,58,237,.18), rgba(6,9,20,0)) , #060914 !important;
    }
    body.vb-force-dark .titleHord{ color:#b9a7ff; }
    body.vb-force-dark .titleOwn{ color:#b57cff; }
    body.vb-force-dark .titleCNSub{ color:#d8def0; }
    body.vb-force-dark .titleDesc{ color:#a7b0c5; }
    body.vb-force-dark .tabs .tab{ color:#d5def3; }
    body.vb-force-dark .reviewBtn,
    body.vb-force-dark .heroCtaBtn{ color:#e5e7eb; }
    body.vb-force-dark .heroCtaBtn.pro{
      background:rgba(22,101,52,.28);
      border-color:rgba(74,222,128,.4);
      color:#bbf7d0;
    }
  </style>
  <style id="manager-theme-unify-v5">
    :root{
      --mgr-l-bg:#f3f0ff;
      --mgr-l-surface:#ffffff;
      --mgr-l-surface-2:#f8f6ff;
      --mgr-l-text:#0f172a;
      --mgr-l-muted:#64748b;
      --mgr-l-border:rgba(15,23,42,.10);
      --mgr-brand:#7c3aed;
      --mgr-brand-2:#8b5cf6;
      --mgr-danger:#dc2626;
      --mgr-danger-soft:#fff1f2;
      --mgr-shadow:0 8px 22px rgba(15,23,42,.08);
    }

    body.vb-force-light,
    body:not(.vb-force-dark){
      background:var(--mgr-l-bg) !important;
      color:var(--mgr-l-text);
    }

    body.vb-force-light .hero,
    body:not(.vb-force-dark) .hero{
      background:var(--mgr-l-bg) !important;
    }
    body.vb-force-light .heroBrandSite,
    body:not(.vb-force-dark) .heroBrandSite{
      color:#64748b;
      border-color:rgba(100,116,139,.28);
      background:#ffffff;
    }

    body.vb-force-light .card,
    body.vb-force-light .toolbar,
    body.vb-force-light .tableWrap,
    body.vb-force-light .word-card,
    body.vb-force-light .sentence-card,
    body.vb-force-light .hintBox,
    body:not(.vb-force-dark) .card,
    body:not(.vb-force-dark) .toolbar,
    body:not(.vb-force-dark) .tableWrap,
    body:not(.vb-force-dark) .word-card,
    body:not(.vb-force-dark) .sentence-card,
    body:not(.vb-force-dark) .hintBox{
      background:var(--mgr-l-surface) !important;
      border:1px solid var(--mgr-l-border) !important;
      box-shadow:var(--mgr-shadow) !important;
    }

    body.vb-force-light .word-title,
    body.vb-force-light .sentence-text,
    body:not(.vb-force-dark) .word-title,
    body:not(.vb-force-dark) .sentence-text{
      color:var(--mgr-l-text) !important;
      font-weight:800;
    }
    body.vb-force-light .word-meaning,
    body.vb-force-light .sentence-translation,
    body:not(.vb-force-dark) .word-meaning,
    body:not(.vb-force-dark) .sentence-translation{
      color:#334155 !important;
      font-weight:600;
    }
    body.vb-force-light .muted,
    body.vb-force-light .small,
    body.vb-force-light .word-meta-line,
    body.vb-force-light .sentence-meta,
    body:not(.vb-force-dark) .muted,
    body:not(.vb-force-dark) .small,
    body:not(.vb-force-dark) .word-meta-line,
    body:not(.vb-force-dark) .sentence-meta{
      color:var(--mgr-l-muted) !important;
    }
    body.vb-force-light .cards .card h3,
    body.vb-force-light .cards .card .value,
    body:not(.vb-force-dark) .cards .card h3,
    body:not(.vb-force-dark) .cards .card .value{
      color:var(--mgr-l-text) !important;
      opacity:1 !important;
    }
    body.vb-force-light .cards .card .label,
    body:not(.vb-force-dark) .cards .card .label{
      color:var(--mgr-l-muted) !important;
      opacity:1 !important;
      font-weight:800 !important;
    }
    body.vb-force-light .cards .card .card-action,
    body:not(.vb-force-dark) .cards .card .card-action{
      color:#64748b !important;
      border-color:rgba(124,58,237,.22) !important;
      background:var(--mgr-l-surface-2) !important;
      font-weight:800 !important;
    }
    body.vb-force-light #dashboard .dash-title,
    body.vb-force-light #dashboard .dash-kpi,
    body.vb-force-light #dashboard .dash-sub,
    body.vb-force-light #dashboard .dash-delta,
    body.vb-force-light #dashboard .dash-compare-kpi .big,
    body.vb-force-light #dashboard .dash-compare-kpi .muted,
    body:not(.vb-force-dark) #dashboard .dash-title,
    body:not(.vb-force-dark) #dashboard .dash-kpi,
    body:not(.vb-force-dark) #dashboard .dash-sub,
    body:not(.vb-force-dark) #dashboard .dash-delta,
    body:not(.vb-force-dark) #dashboard .dash-compare-kpi .big,
    body:not(.vb-force-dark) #dashboard .dash-compare-kpi .muted{
      opacity:1 !important;
      text-shadow:none !important;
    }
    body.vb-force-light #dashboard .dash-title,
    body.vb-force-light #dashboard .dash-kpi,
    body.vb-force-light #dashboard .dash-compare-kpi .big,
    body:not(.vb-force-dark) #dashboard .dash-title,
    body:not(.vb-force-dark) #dashboard .dash-kpi,
    body:not(.vb-force-dark) #dashboard .dash-compare-kpi .big{
      color:#1f2937 !important;
    }
    body.vb-force-light #dashboard .dash-sub,
    body.vb-force-light #dashboard .dash-delta,
    body.vb-force-light #dashboard .dash-compare-kpi .muted,
    body:not(.vb-force-dark) #dashboard .dash-sub,
    body:not(.vb-force-dark) #dashboard .dash-delta,
    body:not(.vb-force-dark) #dashboard .dash-compare-kpi .muted{
      color:#64748b !important;
    }

    /* Keep purple as brand/action only */
    body.vb-force-light a,
    body:not(.vb-force-dark) a{ color:#4f46e5; }
    body.vb-force-light .btn.primary,
    body.vb-force-light .btn.green,
    body.vb-force-light .btn.purple,
    body:not(.vb-force-dark) .btn.primary,
    body:not(.vb-force-dark) .btn.green,
    body:not(.vb-force-dark) .btn.purple{
      background:linear-gradient(135deg,var(--mgr-brand),var(--mgr-brand-2)) !important;
      color:#fff !important;
      border:0 !important;
    }
    body.vb-force-light .btn.ghost,
    body.vb-force-light .btn.yellow,
    body.vb-force-light .btn.dark,
    body:not(.vb-force-dark) .btn.ghost,
    body:not(.vb-force-dark) .btn.yellow,
    body:not(.vb-force-dark) .btn.dark{
      background:var(--mgr-l-surface-2) !important;
      color:#334155 !important;
      border:1px solid var(--mgr-l-border) !important;
    }
    body.vb-force-light .btn.danger-light,
    body:not(.vb-force-dark) .btn.danger-light{
      background:var(--mgr-danger-soft) !important;
      color:#be123c !important;
      border:1px solid #fecdd3 !important;
    }
    body.vb-force-light .btn.danger,
    body.vb-force-light .btn.danger-deep,
    body:not(.vb-force-dark) .btn.danger,
    body:not(.vb-force-dark) .btn.danger-deep{
      background:var(--mgr-danger) !important;
      color:#fff !important;
      border:0 !important;
    }

    body.vb-force-dark{
      background:#060914 !important;
      color:#eef2ff;
    }
    body.vb-force-dark .hero{
      background:radial-gradient(1200px 420px at 30% 0%, rgba(124,58,237,.20), rgba(6,9,20,0)), #060914 !important;
    }
    body.vb-dark .heroBrandChip,
    body.vb-force-dark .heroBrandChip{
      background:rgba(12,18,38,.86) !important;
      border-color:rgba(148,163,184,.34) !important;
      box-shadow:0 8px 18px rgba(0,0,0,.30) !important;
    }
    body.vb-dark .heroBrandMain,
    body.vb-force-dark .heroBrandMain{
      color:#e7ecff !important;
    }
    body.vb-dark .heroBrandMain .hord,
    body.vb-force-dark .heroBrandMain .hord{
      color:#a78bfa !important;
    }
    body.vb-dark .heroBrandSub,
    body.vb-force-dark .heroBrandSub{
      color:#94a3b8 !important;
    }
    body.vb-dark .heroBrandSite,
    body.vb-force-dark .heroBrandSite{
      color:#c4b5fd !important;
      border-color:rgba(167,139,250,.38) !important;
      background:rgba(76,29,149,.28) !important;
    }
    body.vb-force-dark .card,
    body.vb-force-dark .toolbar,
    body.vb-force-dark .tableWrap,
    body.vb-force-dark .word-card,
    body.vb-force-dark .sentence-card,
    body.vb-force-dark .hintBox{
      background:#11172f !important;
      border:1px solid rgba(148,163,184,.26) !important;
      box-shadow:0 10px 26px rgba(0,0,0,.34) !important;
    }
    body.vb-force-dark .word-title,
    body.vb-force-dark .sentence-text{ color:#e7ecff !important; }
    body.vb-force-dark .word-meaning,
    body.vb-force-dark .sentence-translation{ color:#c8d2ea !important; }
    body.vb-force-dark .muted,
    body.vb-force-dark .small,
    body.vb-force-dark .word-meta-line,
    body.vb-force-dark .sentence-meta{ color:#94a3b8 !important; }
    body.vb-force-dark .cards .card h3,
    body.vb-force-dark .cards .card .value,
    body.vb-force-dark #dashboard .dash-title,
    body.vb-force-dark #dashboard .dash-kpi,
    body.vb-force-dark #dashboard .dash-compare-kpi .big{
      color:#e7ecff !important;
      opacity:1 !important;
    }
    body.vb-force-dark .cards .card .label,
    body.vb-force-dark #dashboard .dash-sub,
    body.vb-force-dark #dashboard .dash-delta,
    body.vb-force-dark #dashboard .dash-compare-kpi .muted{
      color:#a7b0c5 !important;
      opacity:1 !important;
    }
    body.vb-force-dark .cards .card .card-action{
      color:#cbd5e1 !important;
      background:#1a2343 !important;
      border-color:rgba(148,163,184,.34) !important;
    }
  </style>
  <link rel="stylesheet" href="export-card.css" />
</head>
<body>
  <div class="hero">
    <div class="container" style="padding:0 14px;">
      <div class="heroHead">
        <h1 class="titleWrap">
          <span class="titleText">
            <span class="titleLine">
              <span class="titleHord">HORD</span>
              <span class="titleDot">·</span>
              <span class="titleCn">霍德英语学习管家</span>
            </span>
            <span class="titleOwn">Yesterday, You Said Tomorrow</span>
            <span class="titleCNSub">构建持久的英语能力</span>
            <span class="titleDesc">在阅读中标记，在复习中掌握。用更稳定的采集体验 + 艾宾浩斯节奏，减少遗忘，让词汇长期沉淀。</span>
            <span class="brandSignature">HORD ENGLISH COMPANION</span>
          </span>
        </h1>
        <div class="heroCtaStack">
          <div class="heroBrandRow">
            <button class="heroBrandChip heroBrandLink" id="btnHeroBrandAction" type="button" title="访问官网">
              <img class="heroBrandLogo" src="logo-square-1024.png" alt="" onerror="this.onerror=null;this.src='icon512.png';" />
              <span class="heroBrandText">
                <span class="heroBrandMain"><span class="hord">HORD</span> · 霍德英语学习管家 <span class="heroBrandSite">官网</span></span>
                <span class="heroBrandSub">HORD English Companion</span>
              </span>
            </button>
          </div>
          <button class="heroCtaBtn primary" id="btnHeroProAction" type="button">升级为专业版</button>
        </div>
      </div>
      <div class="progressRow">
        <div style="min-width:170px;font-weight:900;opacity:.95">学习进度</div>
        <div class="progress"><div id="topProgress"></div></div>
        <div id="topProgressText" style="min-width:120px;text-align:right;font-weight:900;opacity:.95">0%</div>
      </div>
      <div id="reviewMini" class="reviewMini"></div>
      <div class="badgeRow" id="badgeRow" style="margin-top:10px;"></div>
      <div id="dashboard"></div>


      <div class="tabsBar">
        <div class="tabs">
          <button class="tab active" id="tabWords">📚 管理单词本</button>
          <button class="tab" id="tabSentences">✨ 收藏金句库</button>
        </div>
        <button class="reviewBtn" id="btnStartReview">🧠 艾宾浩斯复习</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="cards" id="statCards">
      <!-- injected -->
    </div>

    <div class="toolbar" id="toolbarWords">
      <label class="pill" title="全选"><input type="checkbox" id="checkAll" aria-label="全选"></label>

      <div class="searchPopoverWrap"><input class="input searchInput" id="search" placeholder="搜索" /></div>

      <select class="select" id="sortField">
        <option value="time">按时间</option>
        <option value="alpha">按字母</option>
        <option value="status">按学习状态</option>
        <option value="count">按学习次数</option>
        <option value="mastery">按掌握度</option>
      </select>
      <button class="btn ghost" id="sortDir">⬇️ 倒序</button>

      <button class="btn ghost" id="btnImport">导入</button>
      <button class="btn ghost" id="btnExport">导出</button>
      <div class="pill">
        <label style="display:flex;align-items:center;gap:6px;"><input type="checkbox" id="toggleCn" checked> 中文释义</label>
        <label style="display:flex;align-items:center;gap:6px;margin-left:8px;"><input type="checkbox" id="toggleEn"> 英文释义</label>
        <label style="display:flex;align-items:center;gap:6px;margin-left:8px;"><input type="checkbox" id="toggleNote" checked> 批注</label>
      </div>

      <div class="toolbar-right">
        <button class="btn green" id="btnBulkCycle">批量切换状态</button>
        <button class="btn danger-light" id="btnBulkDelete">批量删除</button>
        <button class="btn danger-deep" id="btnClearWords">清空</button>
        <button class="btn primary" id="btnRefresh">刷新</button>
      </div>
    </div>

    <div class="tableWrap" id="wordsWrap">
      <div id="wordCards" class="word-cards"></div>
      <div class="empty" id="emptyWords" style="display:none;">还没有单词。去网页里“标记生词”，会立刻出现在这里。</div>
    </div>

    <div class="toolbar" id="toolbarSentences" style="display:none;">
      <label class="pill" title="全选"><input type="checkbox" id="checkAllSent" aria-label="全选"></label>
      <div class="searchPopoverWrap"><input class="input searchInput" id="searchSentence" placeholder="搜索" /></div>
      <select class="select" id="sortSentenceField">
        <option value="time">按时间</option>
        <option value="alpha">按字母</option>
        <option value="length">按长度</option>
      </select>
      <button class="btn ghost" id="sortSentenceDir">⬇️ 倒序</button>
      <button class="btn ghost" id="btnImportSent">导入金句</button>
      <button class="btn primary export-core-btn" id="btnExportSent">导出图片</button>
      <div class="pill">
        <label style="display:flex;align-items:center;gap:6px;"><input type="checkbox" id="toggleSentTrans" checked> 翻译</label>
        <label style="display:flex;align-items:center;gap:6px;margin-left:8px;"><input type="checkbox" id="toggleSentNote" checked> 批注</label>
      </div>
      <div class="toolbar-right">
        <button class="btn danger-light" id="btnBulkDeleteSent">批量删除</button>
        <button class="btn danger-deep" id="btnClearSentences">清空</button>
        <button class="btn primary" id="btnRefresh2">刷新</button>
      </div>
    </div>

    <div class="tableWrap" id="sentWrap" style="display:none;">
      <div id="sentCards" class="sent-cards"></div>
      <div class="empty" id="emptySent" style="display:none;">还没有收藏金句。</div>
    </div>

    <div class="hintBox">
      <div style="font-weight:900;margin-bottom:6px;">导入 / 导出格式说明</div>
      <div>1) <b>JSON</b>：单词页仅导入/导出 <code>{ words: [...] }</code>；金句页仅导入/导出 <code>{ sentences: [...] }</code>。</div>
      <div>2) <b>TXT</b>：单词页为 <code>word	meaning	note</code>；金句页为 <code>sentence	translation</code>。</div>
      <div>3) <b>CSV</b>：单词页列为 <code>word,meaning,note,status,reviewCount,phoneticUS,phoneticUK,audioUS,audioUK</code>；金句页列为 <code>text,translation,note,url,title,createdAt</code>。</div>
      <div class="small">去重逻辑：导入时自动合并重复项（不会用空字段覆盖已有释义/批注）。导出文件名会自动带上 <b>版本号 + 时间戳</b>。</div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modalMask" id="modalMask">
    <div class="modal">
      <div class="modalHd">
        <div id="modalTitle">导入/导出</div>
        <button class="btn ghost" id="modalClose" style="padding:8px 10px;">✕</button>
      </div>
      <div class="modalBd">
        <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
          <select class="select" id="ioMode">
            <option value="export">导出</option>
            <option value="import">导入</option>
          </select>
          <select class="select" id="ioFormat">
            <option value="json">JSON（推荐）</option>
            <option value="txt">TXT</option>
            <option value="csv">CSV</option>
          </select>
          <input type="file" id="fileInput" style="display:none" />
          <button class="btn primary" id="btnChooseFile">选择文件</button>
          <button class="btn ghost" id="btnDownloadTemplate">下载模板</button>
        </div>
        <div class="small" id="fileInfo" style="margin-top:8px;display:none;"></div>
        <div id="filePreviewWrap" style="margin-top:8px;display:none;">
          <div class="small" style="margin-bottom:6px;">文件预览（前 80 行）</div>
          <pre id="filePreview" class="filePreview"></pre>
        </div>
        <div style="margin-top:12px;">
          <textarea id="ioText" spellcheck="false" placeholder="导出会在这里生成内容；导入也可以直接把内容粘贴到这里。"></textarea>
        </div>
        <div class="small" id="ioHint" style="margin-top:8px;">提示：导入会自动去重合并（空字段不会覆盖已有数据）。免费版超过 200 词的部分会被拒绝。</div>
        <div class="small" id="ioError" style="margin-top:6px;display:none;"></div>
      </div>
      <div class="modalFt">
        <button class="btn ghost" id="btnCancel">取消</button>
        <button class="btn primary" id="btnOk">确定</button>
      </div>
    </div>
  </div>

  <div class="quoteModalMask" id="quoteExportMask">
    <div class="quoteModal saasQuoteModal">
      <div class="quoteModalHd">
        <div>导出金句卡片</div>
        <button class="btn ghost" id="quoteExportClose" style="padding:8px 10px;">✕</button>
      </div>
      <div class="quoteModalBd">
        <div class="quoteSettings">
          <div class="quoteQuick">
            <div class="quoteSectionTitle">基础设置</div>
            <div class="quoteField">
              <label for="quotePreset">快捷预设</label>
              <select class="select quoteSelect" id="quotePreset">
                <option value="">不使用预设</option>
                <option value="study">学习打卡</option>
                <option value="social">社媒发布</option>
                <option value="minimal">极简收藏</option>
              </select>
            </div>
            <div class="quoteField">
              <label for="quoteTemplate">模板</label>
              <select class="select quoteSelect" id="quoteTemplate">
                <option value="light">Light</option>
                <option value="dark">Dark</option>
                <option value="hordSignature">HORD Signature</option>
                <option value="editorial">Editorial</option>
                <option value="gradientSoft">Gradient Soft</option>
                <option value="boldImpact">Bold Impact</option>
                <option value="letterClassic">Letter Classic</option>
                <option value="parchment">Parchment</option>
                <option value="inkJournal">Ink Journal</option>
                <option value="typewriter">Typewriter</option>
              </select>
            </div>
            <div class="quoteTemplateWall" id="quoteTemplateWall">
              <button class="quoteTplThumb" data-template="light">Light</button>
              <button class="quoteTplThumb" data-template="dark">Dark</button>
              <button class="quoteTplThumb" data-template="hordSignature">HORD Signature</button>
              <button class="quoteTplThumb" data-template="editorial">Editorial</button>
              <button class="quoteTplThumb" data-template="gradientSoft">Gradient Soft</button>
              <button class="quoteTplThumb" data-template="boldImpact">Bold Impact</button>
              <button class="quoteTplThumb" data-template="letterClassic">Letter Classic</button>
              <button class="quoteTplThumb" data-template="parchment">Parchment</button>
              <button class="quoteTplThumb" data-template="inkJournal">Ink Journal</button>
              <button class="quoteTplThumb" data-template="typewriter">Typewriter</button>
            </div>
            <div class="quoteField">
              <label for="quoteRatio">比例</label>
              <select class="select quoteSelect" id="quoteRatio">
                <option value="4:5">4:5 (1080×1350)</option>
                <option value="1:1">1:1 (1080×1080)</option>
                <option value="9:16">9:16 (1080×1920)</option>
                <option value="16:9">16:9 (1280×720)</option>
                <option value="3:4">3:4 (900×1200)</option>
              </select>
            </div>
            <div class="quoteField">
              <label for="quoteDensity">行宽密度</label>
              <select class="select quoteSelect" id="quoteDensity">
                <option value="compact">紧凑</option>
                <option value="standard">标准</option>
                <option value="airy">舒展</option>
              </select>
            </div>
            <div class="quoteField">
              <label for="quoteMainFont">主句字体</label>
              <select class="select quoteSelect" id="quoteMainFont">
                <option value="inter">Inter</option>
                <option value="playfair">Playfair Display</option>
                <option value="garamond">EB Garamond</option>
                <option value="lora">Lora</option>
              </select>
            </div>
            <div class="quoteField">
              <label for="quoteCjkFont">中文字体</label>
              <select class="select quoteSelect" id="quoteCjkFont">
                <option value="notoSansSC">Noto Sans SC</option>
                <option value="notoSerifSC">Noto Serif SC</option>
                <option value="lxgwWenKai">LXGW WenKai</option>
              </select>
            </div>
            <div class="quoteField">
              <label for="quoteFontAdjust">字号微调 <span id="quoteFontAdjustValue">0</span></label>
              <input id="quoteFontAdjust" type="range" min="-8" max="8" step="1" value="0" />
            </div>
            <div class="quoteQuickActions">
              <button class="btn ghost" type="button" id="quoteQuickCopy">快速复制</button>
              <button class="btn primary" type="button" id="quoteQuickExport">快速导出</button>
            </div>
          </div>

          <div class="quoteAdvanced">
            <div class="quoteSection">
              <div class="quoteSectionTitle">内容设置</div>
              <div class="quoteChecks">
                <label><input type="checkbox" id="quoteShowTranslation" checked> 显示翻译</label>
                <label><input type="checkbox" id="quoteShowSource" checked> 显示来源</label>
                <label><input type="checkbox" id="quoteShowAnnotation"> 显示批注</label>
                <label><input type="checkbox" id="quoteShowWatermark" checked> 显示水印</label>
              </div>
              <div class="quoteField">
                <label for="quoteAnnotationStyle">批注样式</label>
                <select class="select quoteSelect" id="quoteAnnotationStyle">
                  <option value="normal">普通</option>
                  <option value="emphasis">强调（引号+底纹）</option>
                </select>
              </div>
              <div class="quoteField">
                <label for="quoteEnhanceContent">单条内容增强</label>
                <label><input type="checkbox" id="quoteEnhanceContent" checked> 自动清洗空白、优化来源展示与换行稳定性</label>
              </div>
              <details class="quoteSection quoteOptionalSection quoteContentOptional">
                <summary>文本覆盖（低频）</summary>
                <div class="quoteField">
                  <label for="quoteSourceOverride">来源文本</label>
                  <div class="quoteInlineAction">
                    <input class="input quoteTextInput" id="quoteSourceOverride" placeholder="可手动覆盖来源，如 nytimes.com/world" />
                    <button class="btn ghost" type="button" id="quoteRestoreSource">恢复</button>
                  </div>
                </div>
                <div class="quoteField">
                  <label for="quoteAnnotationOverride">批注文本</label>
                  <div class="quoteInlineAction">
                    <textarea id="quoteAnnotationOverride" class="quoteTextArea" rows="6" placeholder="可手动编辑导出批注，不会改动原始金句数据"></textarea>
                    <button class="btn ghost" type="button" id="quoteRestoreAnnotation">恢复</button>
                  </div>
                  <div class="quoteHint" id="quoteAnnotationMeta">批注预估：-</div>
                </div>
              </details>
            </div>

            <details class="quoteSection quoteOptionalSection">
              <summary>导出与收藏（高级）</summary>
              <div class="quoteField">
                <label for="quoteWatermarkMode">水印模式</label>
                <select class="select quoteSelect" id="quoteWatermarkMode">
                  <option value="signature">signature</option>
                  <option value="cornerLogo">cornerLogo</option>
                  <option value="backgroundLogo">backgroundLogo</option>
                </select>
              </div>
              <div class="quoteProHint" id="quoteProHint"></div>
              <div class="quoteField">
                <label for="quoteFavoritePreset">模板收藏</label>
                <select class="select quoteSelect" id="quoteFavoritePreset">
                  <option value="">选择收藏...</option>
                </select>
                <div class="quoteFavActions">
                  <button class="btn ghost" id="quoteSaveFavorite" type="button">收藏当前</button>
                  <button class="btn ghost" id="quoteApplyFavorite" type="button">应用收藏</button>
                  <button class="btn ghost" id="quoteDeleteFavorite" type="button">删除收藏</button>
                </div>
              </div>
              <div class="quoteField">
                <label for="quoteFilenamePattern">文件名规则</label>
                <input class="input quoteTextInput" id="quoteFilenamePattern" placeholder="hord-{date}-{template}-{ratio}" />
              </div>
              <div class="quoteHint">支持变量：{date} {time} {datetime} {template} {ratio} {index}</div>
            </details>

            <div class="quoteHint" id="quoteCurrentText">-</div>
          </div>
        </div>
        <div class="quotePreviewArea">
          <div class="quotePreviewTop">
            <div class="quoteQualityHint" id="quoteQualityHint"></div>
            <div class="quotePreviewControls">
              <label for="quotePreviewScale">预览</label>
              <select class="select quotePreviewScale" id="quotePreviewScale">
                <option value="fit">适配</option>
                <option value="0.75">75%</option>
                <option value="1">100%</option>
                <option value="1.25">125%</option>
              </select>
            </div>
          </div>
          <div class="quotePreviewStage" id="quotePreviewStage">
            <div class="quotePreviewWrap">
              <canvas id="quotePreviewCanvas" class="quotePreviewCanvas"></canvas>
            </div>
          </div>
          <div class="quoteHint">预览仅示意排版，导出图始终使用原始分辨率。</div>
          <div class="quoteHint">快捷键：←/→ 切模板，Enter 导出，Shift+Enter 复制。</div>
        </div>
      </div>
      <div class="quoteModalFt">
        <button class="btn ghost" id="quoteExportCancel">取消</button>
        <button class="btn ghost" id="quoteCopyImage">复制图片</button>
        <button class="btn ghost" id="quoteBatchExport">批量导出</button>
        <button class="btn primary" id="quoteExportSubmit">导出 PNG</button>
      </div>
    </div>
  </div>

  <script src="export-card.js"></script>
  <script src="manager.js"></script>
</body>
</html>
